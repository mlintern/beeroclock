/* 
 * Beer O'Clock
 * @jamesrwhite
 * @benhodgson
 */// Set up the store
var preferences={};preferences.supported=function(){try{return window.localStorage!==undefined}catch(e){return!1}};preferences.getInstance=function(){if(this.supported()){window.localStorage.beeroclock===undefined&&(window.localStorage.beeroclock="{}");return JSON.parse(window.localStorage.beeroclock)}};preferences.get=function(e){if(this.supported()){var t=preferences.getInstance();return t[e]!=undefined?JSON.parse(t[e]):undefined}};preferences.set=function(e,t){if(this.supported()){var n=preferences.getInstance();n[e]=t;window.localStorage.beeroclock=JSON.stringify(n);return t}};preferences.unset=function(e){if(this.supported()){var t=preferences.getInstance();delete t[e];window.localStorage.beeroclock=JSON.parse(t)}};var user={};user.getDrink=function(){var e=preferences.get("drink");return e!==undefined?e:user.setDrink(1)};user.setDrink=function(e){preferences.set("drink",e);return e};user.getBubblez=function(){var e=preferences.get("bubblez");return e!==undefined?e:user.setBubblez(!0)};user.setBubblez=function(e){preferences.set("bubblez",e);return e};$(document).ready(function(){var e=17;const t=100;var n={},r,i=window.location.href.split("?")[1],s=$(".countdown-hours > .digit"),o=$(".countdown-minutes > .digit"),u=$(".countdown-seconds > .digit");i=typeof i=="undefined"?[]:i.split("&");query_string={};for(r in i){item=i[r].split("=");query_string[item[0]]=item[1]}typeof query_string.t!="undefined"&&(e=query_string.t);var a={1:{glass:"uk-pint",liquid:"drink-lager",bubbles:!0,bubbles_min:20,bubbles_max:40,bubbles_small:2,bubbles_big:6},2:{glass:"uk-pint",liquid:"drink-ale",bubbles:!1,bubbles_min:"0",bubbles_max:"0",bubbles_small:"0",bubbles_big:"0"},3:{glass:"uk-pint",liquid:"drink-stout",bubbles:!1,bubbles_min:0,bubbles_max:0,bubbles_small:0,bubbles_big:0},4:{glass:"beer-bottle",liquid:"drink-lager-light",bubbles:!0,bubbles_min:10,bubbles_max:30,bubbles_small:2,bubbles_big:4},5:{glass:"hiball",liquid:"drink-gintonic",bubbles:!0,bubbles_min:10,bubbles_max:30,bubbles_small:2,bubbles_big:4},6:{glass:"hiball",liquid:"drink-cola",bubbles:!0,bubbles_min:10,bubbles_max:30,bubbles_small:2,bubbles_big:4},7:{glass:"beer-bottle alcopop-bottle",liquid:"drink-blue-alcopop",bubbles:!0,bubbles_min:10,bubbles_max:30,bubbles_small:1,bubbles_big:2}};n.canHaz=function(){return(new Date).getHours()>=e};n.leadingZero=function(e){return e<10?"0"+e:e};n.formatTime=function(e){var t=this.leadingZero(e.getHours()),n=this.leadingZero(e.getMinutes()),r=this.leadingZero(e.getSeconds());return{hours:t.toString().split(""),minutes:n.toString().split(""),seconds:r.toString().split("")}};n.getDate=function(){var t=new Date;t.getHours()>=e&&t.setDate(t.getDate()+1);t.setHours(e);t.setMinutes(0);t.setSeconds(0);return t};n.howLong=function(){var e=this.getDate(),t=this.canHaz()?e:new Date,n=Math.abs(e.getHours()-t.getHours()-1),r=Math.abs(60-t.getMinutes()),i=Math.abs(60-t.getSeconds()),s=new Date;s.setHours(n);s.setMinutes(r);s.setSeconds(i);return s};n.howLongPercentage=function(){if(this.canHaz())return t;var e=new Date/1e3,n=this.getDate()/1e3;return parseInt(t-(n-e)/86400*100)};n.pour=function(){var e=n.howLong(),t=n.formatTime(e);$.each(s,function(e,n){s[e].innerHTML=t.hours[e]});$.each(o,function(e,n){o[e].innerHTML=t.minutes[e]});$.each(u,function(e,n){u[e].innerHTML=t.seconds[e]});if(n.canHaz()){document.title="It's Beer o'clock now!";$(".beer-oclock-notification").show();$(".countdown-container").hide()}else{var r="";e.getHours()>0&&(r+=e.getHours()+"h ");e.getMinutes()>0&&(r+=e.getMinutes()+"m ");r+=e.getSeconds()+"s ";document.title=r}$(".tasty-beverage").css({height:n.howLongPercentage()+"%"})};n.releaseTheBubblez=function(){var e=$(".bubbles"),t=a[user.getDrink()],n=t.bubbles_min,r=t.bubbles_max,i=t.bubbles_small,s=t.bubbles_big;e.empty();if(t.bubbles){var o=n+Math.floor(Math.random()*(r+1));for(var u=0;u<o;u++)e.append('<div class="bubble-container"><div class="bubble"></div></div>')}e.find("> .bubble-container").each(function(){var e=i+Math.floor(Math.random()*(s+1)),t=Math.floor(Math.random()*101),n=Math.floor(Math.random()*16),r=3+Math.floor(Math.random()*9),o=$(this);o.css({left:t+"%","-webkit-animation-duration":r+"s","-moz-animation-duration":r+"s","-ms-animation-duration":r+"s","animation-duration":r+"s","-webkit-animation-delay":n+"s","-moz-animation-delay":n+"s","-ms-animation-delay":n+"s","animation-delay":n+"s"});o.children(".bubble").css({width:e+"px",height:e+"px"})})};n.bubblesOn=function(){n.releaseTheBubblez();$(".bubbles").fadeIn("1000",function(){$(".bubble-container").css({"animation-play-state":"running","-webkit-animation-play-state":"running"});$(".bubble-toggle").text("Bubbles Off")})};n.bubblesOff=function(){$(".bubbles").fadeOut("2500",function(){$(".bubble-container").css({"animation-play-state":"paused","-webkit-animation-play-state":"paused"});$(".bubbles").empty();$(".bubble-toggle").text("Bubbles On")})};n.toggleBubblez=function(){if(!user.getBubblez()){user.setBubblez(!0);n.bubblesOn()}else{user.setBubblez(!1);n.bubblesOff()}};n.render=function(){var e=a[user.getDrink()];$("#drink-type").removeClass().fadeOut("100",function(){$(this).addClass(e.glass+" "+e.liquid).fadeIn("250")});$(".bubbles").empty();e.bubbles&&user.getBubblez()&&this.releaseTheBubblez(user.getDrink());var t=$(".bubble-toggle");e.bubbles?t.show():t.hide();user.getBubblez()?t.text("Bubbles Off"):t.text("Bubbles On")};$("#drink-list").on("change",function(){user.setDrink($(this).find(":selected").val());n.render()});$(".bubble-toggle").on("click",n.toggleBubblez);$(".settings-toggle").on("click",function(){$("#drink-list").find('> option[value="'+user.getDrink()+'"]')[0].selected=!0;$(".settings-panel, .site-footer").slideToggle()});typeof query_string.drink!="undefined"&&user.setDrink(query_string.drink);n.render();setTimeout(function(){n.pour();setInterval(n.pour,1e3)},1e3);window.drink=n});(function(e){e.fn.extend({customSelect:function(t){var n={customClass:null,mapClass:!0,mapStyle:!0},r=function(t,n){var r=t.find(":selected"),i=n.children(":first"),s=r.html()||"&nbsp;";i.html(s);setTimeout(function(){n.removeClass("customSelectOpen");e(document).off("mouseup.customSelectOpen")},60)};if(typeof document.body.style.maxHeight=="undefined")return this;t=e.extend(n,t);return this.each(function(){var n=e(this),i=e('<span class="customSelectInner" />'),s=e('<span class="customSelect" />');s.append(i);n.after(s);t.customClass&&s.addClass(t.customClass);t.mapClass&&s.addClass(n.attr("class"));t.mapStyle&&s.attr("style",n.attr("style"));n.addClass("hasCustomSelect").on("update",function(){r(n,s);var e=parseInt(n.outerWidth(),10)-(parseInt(s.outerWidth(),10)-parseInt(s.width(),10));s.css({display:"inline-block"});var t=s.outerHeight();n.attr("disabled")?s.addClass("customSelectDisabled"):s.removeClass("customSelectDisabled");i.css({width:e,display:"inline-block"});n.css({"-webkit-appearance":"menulist-button",width:s.outerWidth(),position:"absolute",opacity:0,height:t,fontSize:s.css("font-size")})}).on("change",function(){s.addClass("customSelectChanged");r(n,s)}).on("keyup",function(){if(!s.hasClass("customSelectOpen")){n.blur();n.focus()}}).on("mouseup",function(t){s.removeClass("customSelectChanged");if(!s.hasClass("customSelectOpen")){s.addClass("customSelectOpen");t.stopPropagation();e(document).one("mouseup.customSelectOpen",function(t){t.target!=n.get(0)&&e.inArray(t.target,n.find("*").get())<0?n.blur():r(n,s)})}}).focus(function(){s.removeClass("customSelectChanged").addClass("customSelectFocus")}).blur(function(){s.removeClass("customSelectFocus customSelectOpen")}).hover(function(){s.addClass("customSelectHover")},function(){s.removeClass("customSelectHover")}).trigger("update")})}})})(jQuery);$(window).on("load",function(){(function(e,t,n){var r,i=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;r=e.createElement(t);r.id=n;r.async=!0;r.src="//connect.facebook.net/en_GB/all.js#xfbml=1&appId=441260642628600";i.parentNode.insertBefore(r,i)})(document,"script","facebook-jssdk");!function(e,t,n){var r,i=e.getElementsByTagName(t)[0];if(!e.getElementById(n)){r=e.createElement(t);r.id=n;r.src="//platform.twitter.com/widgets.js";i.parentNode.insertBefore(r,i)}}(document,"script","twitter-wjs");window.___gcfg={lang:"en-GB"};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src="https://apis.google.com/js/plusone.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();$(".social-sharing").delay(500).fadeIn();$("select.styled").customSelect()});